<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Скрипт для push-уведомлений Altcraft -->
    <script>
        (function (window, document, dataLayerName, containerID) {
            window[dataLayerName] = window[dataLayerName] || [];
            window[dataLayerName].push({ 'start': new Date().getTime(), event: 'actm-js' });
            var firstScript = document.getElementsByTagName('script')[0];
            var script = document.createElement('script');
            var dl = dataLayerName !== 'acDataLayer' ? '&l=' + dataLayerName : '';
            script.async = true;
            script.src = 'https://pxl.demo.altcraft.com/actm/js/actm.js?id=' + containerID + dl;
            script.type = 'module';
            if (firstScript && firstScript.parentNode) {
                firstScript.parentNode.insertBefore(script, firstScript);
            }
        }(window, document, 'acDataLayer', 'ATM-9RyRukqravy7Jjtz_'));
    </script>
    <title>Онлайн Книжный Магазин</title>
    <style>
        /* Стили остаются без изменений */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            color: #333;
        }
        /* ... остальные стили ... */
    </style>
</head>
<body>
    <script src="https://pxl.demo.altcraft.com/ak_container.js?id=MTg1fDM="></script>

    <!-- Остальная часть HTML остается без изменений -->
    <header>
        <h1>Книжный Уголок</h1>
        <div class="cart-info">
            Корзина: <span id="cart-counter">0</span> товаров
        </div>
        <nav>
            <ul>
                <li><a href="#">Главная</a></li>
                <li><a href="#">Каталог</a></li>
                <li><a href="#">О нас</a></li>
                <li><a href="#">Контакты</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero">
            <h2>Добро пожаловать в наш книжный магазин!</h2>
            <p>Откройте для себя мир увлекательных историй</p>
            
            <div class="push-container">
                <button id="init_sub">Подписаться на уведомления</button>
            </div>
        </section>

        <section class="featured-books">
            <h2>Рекомендуемые книги</h2>
            <div class="book-grid">
                <!-- Книги с классом add-to-cart для триггера -->
                <div class="book-card">
                    <img src="images/book1.jpg" alt="Война и мир">
                    <h3>Война и мир</h3>
                    <p>Автор: Лев Толстой</p>
                    <p>Цена: 450 руб.</p>
                    <button class="add-to-cart" onclick="addToCart('Война и мир')">
                        В корзину
                    </button>
                </div>
                <!-- Остальные книги ... -->
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2023 Книжный Уголок. Все права защищены.</p>
    </footer>

    <script>
        // Функция добавления в корзину с отправкой события
        function addToCart(bookTitle) {
            // Увеличиваем счетчик
            const counter = document.getElementById('cart-counter');
            counter.textContent = parseInt(counter.textContent) + 1;
            
            // Отправляем событие в Altcraft
            if(window.acDataLayer) {
                window.acDataLayer.push({
                    event: 'add_to_cart',
                    book_title: bookTitle,
                    eventType: 'click',
                    eventCategory: 'cart',
                    eventAction: 'add',
                    eventLabel: bookTitle
                });
            }
        }

        // Обработчик для кнопки подписки
        document.getElementById('init_sub').addEventListener('click', function() {
            try {
                var akPush = new AKPush();
                akPush.initSubscription();
            }
            catch (e) {
                console.log(e);
            }
        });

        // Автоматическая отправка событий клика для кнопок с классом add-to-cart
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', function() {
                    if(window.acDataLayer) {
                        window.acDataLayer.push({
                            event: 'button_click',
                            eventType: 'click',
                            eventCategory: 'button',
                            eventAction: 'click',
                            eventLabel: 'Add to Cart'
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>
